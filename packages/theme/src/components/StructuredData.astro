---
import { siteConfig } from "@/site.config";
import type { CollectionEntry } from "astro:content";

type Props = {
	post?: CollectionEntry<"post"> | CollectionEntry<"artykul">;
	type?: "website" | "article";
};

const { post, type = "website" } = Astro.props;

const structuredData = post
	? {
			"@context": "https://schema.org",
			"@type": "BlogPosting",
			headline: post.data.title,
			description: post.data.description,
			author: {
				"@type": "Person",
				name: siteConfig.author,
			},
			datePublished: post.data.publishDate.toISOString(),
			...(post.data.updatedDate && {
				dateModified: post.data.updatedDate.toISOString(),
			}),
			image: post.data.coverImage
				? new URL(post.data.coverImage.src.src, Astro.site).href
				: new URL("/social-card.png", Astro.site).href,
			url: new URL(Astro.url.pathname, Astro.site).href,
			publisher: {
				"@type": "Person",
				name: siteConfig.author,
			},
			mainEntityOfPage: {
				"@type": "WebPage",
				"@id": new URL(Astro.url.pathname, Astro.site).href,
			},
			...(post.data.tags &&
				post.data.tags.length > 0 && {
					keywords: post.data.tags.join(", "),
				}),
		}
	: {
			"@context": "https://schema.org",
			"@type": "WebSite",
			name: siteConfig.title,
			description: siteConfig.description,
			url: siteConfig.url,
			author: {
				"@type": "Person",
				name: siteConfig.author,
			},
			inLanguage: siteConfig.lang,
		};
---

<script type="application/ld+json" set:html={JSON.stringify(structuredData)} />
