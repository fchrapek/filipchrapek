---
import { getWebmentionsForUrl } from "@/utils/webmentions";
import Comments from "./Comments.astro";
import Likes from "./Likes.astro";

const url = new URL(Astro.url.pathname, Astro.site);

const webMentions = await getWebmentionsForUrl(`${url}`);

// Return if no webmentions
if (!webMentions.length) return;
---

<div class="webmentions">
	<hr style="border-style: solid" />
	<h2 class="webmentions__title">Webmentions for this post</h2>
	<div class="webmentions__sections">
		<Likes mentions={webMentions} />
		<Comments mentions={webMentions} />
	</div>
	<p class="webmentions__footer">
		Responses powered by{" "}
		<a href="https://webmention.io" rel="noreferrer" target="_blank">Webmentions</a>
	</p>
</div>
